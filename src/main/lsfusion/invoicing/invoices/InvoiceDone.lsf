MODULE InvoiceDone;

REQUIRE InvoiceReady, Time;

NAMESPACE Invoicing;

EXTEND CLASS InvoiceStatus {
    done 'Оплачено'
}
done 'Оплачено' = DATA BOOLEAN (Invoice);

status(Invoice b) += WHEN done(b) THEN InvoiceStatus.done;

EXTEND FORM invoice
    PROPERTIES(i) done 
;

EXTEND FORM invoices 
    EXTEND FILTERGROUP status
        FILTER 'Оплачено' status(i) = InvoiceStatus.done 'F7'
;

DESIGN invoice {                               
    status {
        MOVE PROPERTY(done(i));                              
    }                 
}

EXTEND FORM item
    OBJECTS il = InvoiceLine
    PROPERTIES(il) READONLY nameStatus, date, nameCustomer, nameCompany
    PROPERTIES(il) READONLY nameItem, quantity, unitPrice
    FILTERS item(il) = i
;

DESIGN item {
    tabs {
        NEW invoices {
            caption = 'Расходные накладные';
            MOVE BOX(il);
        }
    }
}