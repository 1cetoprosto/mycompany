MODULE CostLocation;

REQUIRE Location;

NAMESPACE Inventory;

calcCost 'Расчет себестоимости' = DATA BOOLEAN (Location);

costLocation (Location l) = 
    GROUP LAST Location parent ORDER DESC level(l, parent) 
          WHERE calcCost(l) OR NOT parent(l) MATERIALIZED;